Scala Code (Correlation between case count and subway ridership and case count and buses for first month of COVID)

var cases1stMonth = spark.read.format("csv").option("header", "true").load("final/spark/1stMonth/input/1stMonth.csv") 
var mta1stMonth = spark.read.format("csv").option("header", "true").load("final/spark/1stMonth/input/MTA1stMonth.csv")
mta1stMonth = mta1stMonth.withColumnRenamed("date", "DATE_OF_INTEREST")
cases1stMonth = cases1stMonth.join(mta1stMonth, "DATE_OF_INTEREST")
cases1stMonth = cases1stMonth.withColumnRenamed("CASE_COUNT       ", "CASE_COUNT")
cases1stMonth = cases1stMonth.withColumnRenamed(" Subways", "Subways")
cases1stMonth = cases1stMonth.withColumn("CASE_COUNT", col("CASE_COUNT").cast("double"))
cases1stMonth = cases1stMonth.withColumn("Subways", col("Subways").cast("double"))
cases1stMonth.stat.corr("CASE_COUNT", "Subways") 
cases1stMonth = cases1stMonth.withColumnRenamed("Buses    ", "Buses")
cases1stMonth = cases1stMonth.withColumn("Buses", col("Buses").cast("double"))
cases1stMonth.stat.corr("CASE_COUNT", "Buses")
